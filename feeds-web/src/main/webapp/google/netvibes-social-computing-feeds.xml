<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:widget="http://www.netvibes.com/ns/">
<head>
<title>Just Map It! Feeds</title>
<meta name="author" content="Social Computing" />
<meta name="email" content="justmapit@social-computing.com" />
<meta name="website" content="http://www.social-computing.com" />
<meta name="description" content="Just Map It! Feeds lets you view and navigate your feeds thru an interactive map! by Social Computing" />
<meta name="keywords" content="rss, netvibes, google, blogger, feeds, feed, map, cartography, visualization, social, blog, gadget, widget, social computing, category, representation, information" />
<meta name="version" content="1.0 alpha" />
<meta name="screenshot" content="http://feeds.just-map-it.com/images/screenshot.png" />
<meta name="thumbnail" content="http://feeds.just-map-it.com/images/thumbnail.png" />
<meta name="autoRefresh" content="120" />
<link rel="shortcut icon" href="http://feeds.just-map-it.com/favicon.ico" />
<widget:preferences>
	<preference name="feed" type="text" label="Feed" defaultValue="http://www.social-computing.com/feed/" />
</widget:preferences>
 <script type="text/javascript" >
widget.onLoad = function() {
	var flashvars = {
		allowDomain: "*",
		wpsserverurl: "http%3A%2F%2Fserver.just-map-it.com%2F",
		wpsplanname: "Feeds",
			analysisProfile: "GlobalProfile",
			feed: widget.getValue( "feed")
	};
	var fv='';
	for (var prop in flashvars) {
		if (fv) fv=fv+String.fromCharCode(38);
		fv=fv + prop + '=' + flashvars[prop];
	}
	var div = widget.createElement( 'div',  { 'style': 'margin: 0 auto;text-align:center;'} );	
	var object = widget.createElement( 'object',  
		{ 	'type': 'application/x-shockwave-flash',
			'data': 'http://feeds.just-map-it.com/client/jmi-flex-1.0-SNAPSHOT.swf',
			'id': 'wps-feeds',
			'name': 'wps-feeds',
			'width': widget.body.getDimensions().width-20,
			'height': widget.body.getDimensions().width-20
		 });
	addParams( object, fv);
	object.appendChild( widget.createElement( 'param', { 'name':'movie', 'value':'http://feeds.just-map-it.com/client/jmi-flex-1.0-SNAPSHOT.swf'}));
	var embed = widget.createElement( 'embed',  
		{ 	'type': 'application/x-shockwave-flash',
			'src': 'http://feeds.just-map-it.com/client/jmi-flex-1.0-SNAPSHOT.swf',
			'id': 'wps-feeds',
			'name': 'wps-feeds',
			'align': 'middle',
			'width': widget.body.getDimensions().width-20,
			'height': widget.body.getDimensions().width-20
		 });
	addParams( embed, fv);
	object.appendChild( embed);
	div.appendChild( object);
	widget.setBody( div);
	//widget.onResize();
}
function addParams( parent, flashvars) {
	parent.appendChild( widget.createElement( 'param', { 'name':'quality', 'value':'high'}));
	parent.appendChild( widget.createElement( 'param', { 'name':'bgcolor', 'value':'#FFFFFF'}));
	parent.appendChild( widget.createElement( 'param', { 'name':'allowscriptaccess', 'value':'always'}));
	parent.appendChild( widget.createElement( 'param', { 'name':'allowfullscreen', 'value':'true'}));
	parent.appendChild( widget.createElement( 'param', { 'name':'flashvars', 'value':flashvars}));
	parent.appendChild( widget.createElement( 'param', { 'name':'wmode', 'value':'opaque'}));
}
function ready() {
  var elements = widget.body.getElementsByTagName("object");
  var map = elements[elements.length-1];
  var titles = map.getArrayProperty( "$FEEDS_TITLES");
  if( map.getProperty( "$analysisProfile") == "GlobalProfile"){ // and titles) {
	widget.setTitle( 'Just Map It! Feeds - ' + titles.join( ', '));
  }
}
function status( status) {
// do something here
}
function empty() {
	widget.setTitle( 'Just Map It! Feeds');
	widget.setBody( "Sorry, the map is empty. Does the feed contains categories?");
}
function error( error) {
	widget.setTitle( 'Just Map It! Feeds');
	widget.setBody( "Sorry, an error occured. Is this URL correct?");
}
function JMIF_Navigate( url) {
	window.open( url, "_blank");
}
function JMIF_Focus( args)
{
	var parameters = {};
	parameters["entityId"] = args[0];
	parameters["feed"] = args[2];
	var elements = widget.body.getElementsByTagName("object");
	elements[elements.length-1].compute( parameters);
}
function JMIF_Center( args)
{
	var parameters = {};
	parameters["attributeId"] = args[0];
	parameters["analysisProfile"] = "DiscoveryProfile";
	parameters["feed"] = args[2];
	var elements = widget.body.getElementsByTagName("object");
	elements[elements.length-1].compute( parameters);
}
widget.onResize = function() {
	var elements = widget.body.getElementsByTagName("object");
	var flash = elements[elements.length-1];
	if (flash) {
		flash.width = widget.body.getDimensions().width;
		flash.height = widget.body.getDimensions().height;
	}
}
</script>
</head>
<body>
<p>Loading...</p>
</body>
</html>
